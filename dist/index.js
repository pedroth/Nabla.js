!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Nabla=e():t.Nabla=e()}(window,(function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,r){"use strict";r.r(e),r.d(e,"Canvas",(function(){return m})),r.d(e,"Canvas2D",(function(){return w})),r.d(e,"ImageIO",(function(){return i})),r.d(e,"Stream",(function(){return b})),r.d(e,"ArrayUtils",(function(){return N})),r.d(e,"Sort",(function(){return M})),r.d(e,"EditDistance",(function(){return L}));const n={getImageCanvas:t=>{const e=document.createElement("canvas");e.width=t.width,e.height=t.height;const r=e.getContext("2d");return r.fillStyle="rgba(0, 0, 0, 0)",r.globalCompositeOperation="source-over",r.fillRect(0,0,e.width,e.height),r.drawImage(t,0,0),e},getDataFromImage:t=>(canvas=n.getImageCanvas(t),canvas.getContext("2d").getImageData(0,0,t.width,t.height)),loadImage:t=>{const e=new Image;return e.src=t,e.isReady=!1,e.onload=()=>e.isReady=!0,e},generateImageReadyPredicate:t=>()=>t.isReady};var i=n;function a(t,e){var r=[];return r[0]=t[0]+e[0],r[1]=t[1]+e[1],r}function o(t){var e=[];return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e}function s(t,e){var r=[];return r[0]=t[0]-e[0],r[1]=t[1]-e[1],r}function h(t,e){return t[0]*e[0]+t[1]*e[1]}function c(t){return h(t,t)}function u(t){return Math.sqrt(h(t,t))}function l(t,e){var r=[];return r[0]=Math.min(t[0],e[0]),r[1]=Math.min(t[1],e[1]),r}function f(t,e){var r=[];return r[0]=Math.max(t[0],e[0]),r[1]=Math.max(t[1],e[1]),r}function p(t,e,r){var n=r[1]/t[1];return[n,(-t[0]*n+r[0])/e]}function g(t,e,r){var n=r[0]/t[0];return[n,(-t[1]*n+r[1])/e]}var d=function(t){this.canvas=t,this.ctx=t.getContext("2d"),this.image=this.ctx.getImageData(0,0,t.width,t.height),this.imageData=this.image.data};d.prototype.getSize=function(){return[this.canvas.height,this.canvas.width]},d.prototype.paintImage=function(){this.ctx.putImageData(this.image,0,0)},d.prototype.getCanvas=function(){return this.canvas},d.prototype.clearImage=function(t){this.useCanvasCtx(e=>{var r=e.getSize();e.ctx.fillStyle="rgba("+t[0]+","+t[1]+","+t[2]+","+t[3]+")",e.ctx.globalCompositeOperation="source-over",e.ctx.fillRect(0,0,r[1],r[0])},!0)},d.prototype.useCanvasCtx=function(t,e=!1){e||this.ctx.putImageData(this.image,0,0),t(this),this.image=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height),this.imageData=this.image.data},d.prototype.getImageIndex=function(t){return 4*(this.canvas.width*t[0]+t[1])},d.prototype.getPxl=function(t){var e=this.getImageIndex(t);return[this.imageData[e],this.imageData[e+1],this.imageData[e+2],this.imageData[e+3]]},d.prototype.drawPxl=function(t,e){var r=this.getImageIndex(t);this.imageData[r]=e[0],this.imageData[r+1]=e[1],this.imageData[r+2]=e[2],this.imageData[r+3]=e[3]},d.prototype.drawLine=function(t,e,r){r.points=[t,e];var n=[];n.push(t),n.push(e);for(var i=[],a=[],o=0;o<n.length;o++){0<=(f=n[o])[0]&&f[0]<this.canvas.height&&0<=f[1]&&f[1]<this.canvas.width?i.push(f):a.push(f)}if(2!=i.length){var c=[],u=[e[0]-t[0],e[1]-t[1]];c.push(p(u,-(this.canvas.height-1),[-t[0],-t[1]])),c.push(g(u,-(this.canvas.width-1),[this.canvas.height-1-t[0],-t[1]])),c.push(p(u,this.canvas.height-1,[this.canvas.height-1-t[0],this.canvas.width-1-t[1]])),c.push(g(u,this.canvas.width-1,[-t[0],this.canvas.width-1-t[1]]));var l=[];for(o=0;o<c.length;o++){var f;0<=(f=c[o])[0]&&f[0]<=1&&0<=f[1]&&f[1]<=1&&l.push(f)}if(0!=l.length)if(i.length>0){var d=[t[0]+l[0][0]*u[0],t[1]+l[0][0]*u[1]];this.drawLineInt(i.pop(),d,r)}else{var m=[t[0]+l[0][0]*u[0],t[1]+l[0][0]*u[1]];for(o=1;o<l.length;o++){if(h(u=s(d=[t[0]+l[o][0]*u[0],t[1]+l[o][0]*u[1]],m),u)>.001)return void this.drawLineInt(m,d,r)}this.drawLineInt(m,m,r)}}else this.drawLineInt(i[0],i[1],r)},d.prototype.drawLineInt=function(t,e,r){t=o(t),e=o(e);var n=[-1,0,1],i=n.length,c=i*i,u=[];u[0]=t[0],u[1]=t[1];var l=s(e,t),f=[];for(f[0]=-l[1],f[1]=l[0],r(u,r.points,this);u[0]!==e[0]||u[1]!==e[1];){for(var p=Number.MAX_VALUE,g=[],d=0;d<c;d++){var m=n[d%i],y=n[Math.floor(d/i)],v=s(a(u,[m,y]),t),w=Math.abs(h(v,f))-h(v,l);p>w&&(p=w,g=[m,y])}r(u=a(u,g),r.points,this)}r(u,r.points,this)},d.prototype.drawPolygon=function(t,e,r=d.isInsidePolygon){let n=[[Number.MAX_VALUE,Number.MAX_VALUE],[Number.MIN_VALUE,Number.MIN_VALUE]];for(let e=0;e<t.length;e++)n[0]=l(t[e],n[0]),n[1]=f(t[e],n[1]);let i=s(this.getSize(),[1,1]),a=[0,0];n[0]=o(l(i,f(a,n[0]))),n[1]=o(l(i,f(a,n[1])));for(var h=n[0][0];h<n[1][0];h++)for(var c=n[0][1];c<n[1][1];c++){var u=[h,c];r(u,t)&&e(u,t,this)}},d.prototype.drawTriangle=function(t,e,r,n){var i=[t,e,r];this.drawPolygon(i,n,d.isInsideConvex)},d.prototype.drawQuad=function(t,e,r,n,i){this.drawPolygon([t,e,r,n],i)},d.prototype.drawImage=function(t,e){"isReady"in t&&!t.isReady||this.useCanvasCtx(r=>r.ctx.drawImage(t,e[1],e[0]))},d.prototype.drawCircle=function(t,e,r){var n=function(t,e){var r=[];return r[0]=t[0]*e,r[1]=t[1]*e,r}([1,1],e),i=[s(t,n),a(t,n)],h=this.getSize();i[0]=o(l(s(h,[1,1]),f([0,0],i[0]))),i[1]=o(l(s(h,[1,1]),f([0,0],i[1])));for(var c=i[0][0];c<=i[1][0];c++)for(var u=i[0][1];u<=i[1][1];u++){var p=[c,u];this.isInsideCircle(p,t,e)&&r(p,[t,e],this)}},d.prototype.isInsideCircle=function(t,e,r){return c(s(t,e))<=r*r},d.prototype.addEventListener=function(t,e,r){this.canvas.addEventListener(t,e,r)},d.prototype.drawString=function(t,e,r){this.useCanvasCtx(n=>{r(n.ctx),n.ctx.fillText(e,t[1],t[0])})},d.isInsidePolygon=function(t,e){for(var r=[],n=0,i=e.length,a=0;a<i;a++)r[0]=s(e[(a+1)%i],t),r[1]=s(e[a],t),n+=Math.acos(h(r[0],r[1])/(u(r[0])*u(r[1])));return Math.abs(n-2*Math.PI)<.001},d.isInsideConvex=function(t,e){for(var r=e.length,n=[],i=[],a=0;a<r;a++){n[a]=s(e[(a+1)%r],e[a]);let o=[-n[a][1],n[a][0]],c=s(t,e[a]);i[a]=h(c,o)}let o=n[0][0]*n[1][1]-n[0][1]*n[1][0]>0?1:-1;for(a=0;a<r;a++){if(i[a]*o<0)return!1}return!0},d.simpleShader=function(t){return(e,r,n)=>n.drawPxl(e,t)},d.colorShader=function(t){return d.interpolateTriangleShader((e,r,n,i)=>{for(var a=[0,0,0,0],o=0;o<r.length;o++)a[0]=a[0]+t[o][0]*i[o],a[1]=a[1]+t[o][1]*i[o],a[2]=a[2]+t[o][2]*i[o],a[3]=a[3]+t[o][3]*i[o];n.drawPxl(e,a)})},d.interpolateQuadShader=function(t){return function(e,r,n){var i=[r[0],r[1],r[2]],a=[r[2],r[3],r[0]],o=d.triangleBaryCoord(e,i);o[0]>0&&o[1]>0&&o[2]>0&&Math.abs(o[0]+o[1]+o[2]-1)<1e-10?t(e,r,n,[o[0],o[1],o[2],0]):(o=d.triangleBaryCoord(e,a),t(e,r,n,[o[2],0,o[0],o[1]]))}},d.interpolateTriangleShader=function(t){return(e,r,n)=>{alpha=d.triangleBaryCoord(e,r),t(e,r,n,alpha)}},d.interpolateLineShader=function(t){return(e,r,n)=>{var i=s(r[1],r[0]),a=s(e,r[0]),o=c(i),u=h(a,i);t(e,r,n,0==o?0:u/o)}},d.quadTextureShader=function(t,e,r=d.bilinearInterpolation){let n=null;return d.interpolateQuadShader((h,c,u,p)=>{t.isReady&&null!=n||(n=new d(i.getImageCanvas(t)));const g=n,m=g.getSize(),y=[0,0];for(let t=0;t<e.length;t++)y[0]=y[0]+e[t][0]*p[t],y[1]=y[1]+e[t][1]*p[t];var v=[(1-y[1])*(m[1]-1),(m[0]-1)*y[0]],w=o(v=f([0,0],l(s([m[0],m[1]],[1,1]),v))),x=[g.getPxl(w),g.getPxl(a(w,[1,0])),g.getPxl(a(w,[1,1])),g.getPxl(a(w,[0,1]))],S=r(x,s(v,w));u.drawPxl(h,S)})},d.triangleCache=(()=>{const t=[];return{constains:e=>null!=t[e%3],get:e=>t[e%3],set:(e,r)=>t[e%3]=r}})(),d.triangleHash=t=>[t[0][0],t[1][0],t[2][0],t[0][1],t[1][1],t[2][1]].reduce((t,e)=>31*t+e,1),d.triangleBaryCoord=function(t,e){const r=d.triangleHash(e),n=[t[0]-e[0][0],t[1]-e[0][1]];if(!d.triangleCache.constains(r)){const t=[e[1][0]-e[0][0],e[1][1]-e[0][1]],n=[e[2][0]-e[0][0],e[2][1]-e[0][1]],i=t[0]*n[1]-t[1]*n[0];d.triangleCache.set(r,{triangle:e,u:t.map(t=>t/i),v:n.map(t=>t/i),det:i,hash:r})}const i=d.triangleCache.get(r),a=i.u,o=i.v;if(0==i.det)return[0,0,0];var s=[o[1]*n[0]-o[0]*n[1],a[0]*n[1]-a[1]*n[0]];return[1-s[0]-s[1],s[0],s[1]]},d.bilinearInterpolation=function(t,e){for(var r=[],n=0;n<t.length;n++){var i=t[0][n]+(t[3][n]-t[0][n])*e[1],a=i+(t[1][n]+(t[2][n]-t[1][n])*e[1]-i)*e[0];r.push(a)}return r},d.createCanvas=function(t,e){const r=document.createElement("canvas");return r.setAttribute("width",t[0]),r.setAttribute("height",t[1]),document.getElementById(e).appendChild(r),r};var m=d,v=function(t,e){if(m.call(this,t),2!=e.length||2!=e[0].length&&2!=e[1].length)throw"camera space must be 2-dim array with 2-dim arrays representing an interval";this.cameraSpace=e};(v.prototype=Object.create(m.prototype)).constructor=v,v.prototype.integerTransform=function(t){return[-(this.canvas.height-1)/(this.cameraSpace[1][1]-this.cameraSpace[1][0])*(t[1]-this.cameraSpace[1][1]),(this.canvas.width-1)/(this.cameraSpace[0][1]-this.cameraSpace[0][0])*(t[0]-this.cameraSpace[0][0])]},v.prototype.inverseTransform=function(t){return[this.cameraSpace[0][0]+(this.cameraSpace[0][1]-this.cameraSpace[0][0])/(this.canvas.width-1)*t[1],this.cameraSpace[1][1]-(this.cameraSpace[1][1]-this.cameraSpace[1][0])/(this.canvas.height-1)*t[0]]},v.prototype.drawLine=function(t,e,r){y1=this.integerTransform(t),y2=this.integerTransform(e),m.prototype.drawLine.call(this,y1,y2,r)},v.prototype.drawTriangle=function(t,e,r,n){y1=this.integerTransform(t),y2=this.integerTransform(e),y3=this.integerTransform(r),m.prototype.drawTriangle.call(this,y1,y2,y3,n)},v.prototype.drawQuad=function(t,e,r,n,i){y1=this.integerTransform(t),y2=this.integerTransform(e),y3=this.integerTransform(r),y4=this.integerTransform(n),m.prototype.drawQuad.call(this,y1,y2,y3,y4,i)},v.prototype.drawCircle=function(t,e,r){y=this.integerTransform(t),z=this.integerTransform([e,0])[1]-this.integerTransform([0,0])[1],m.prototype.drawCircle.call(this,y,z,r)},v.prototype.drawImage=function(t,e){m.prototype.drawImage.call(this,t,this.integerTransform(e))},v.prototype.drawString=function(t,e,r){y=this.integerTransform(t),m.prototype.drawString.call(this,y,e,r)},v.prototype.setCamera=function(t){if(2!=t.length||2!=t[0].length&&2!=t[1].length)throw"camera space must be 2-dim array with 2-dim arrays representing an interval";this.cameraSpace=t};var w=v;const x=function(t){this.f=t};x.prototype.compose=function(t){return new x(e=>this.f(t(e)))},x.prototype.leftCompose=function(t){return new x(e=>t(this.f(e)))},x.prototype.apply=function(t){return this.f(t)},x.prototype.get=function(){return this.f},x.of=function(t){return new x(t)};var S=x,I=function(t,e=(t=>t),r=(t=>!0)){this.gen=t,this.mapFunction=e,this.filterPredicate=r};I.prototype.state=function(){return this.gen.state},I.prototype.hasNext=function(){return this.gen.hasNext(this.filteredState())},I.prototype.filteredState=function(){for(var t=this.state();this.gen.hasNext(t)&&!this.filterPredicate(this.gen.peek(t));)t=this.gen.next(t);return t},I.prototype.head=function(){let t=this.filteredState();if(this.gen.hasNext(t))return this.gen.peek(t);throw"No head element exception"},I.prototype.tail=function(){return new I(I.generatorOf(this.gen.next(this.filteredState()),this.gen.next,this.gen.peek,this.gen.hasNext),this.mapFunction,this.filterPredicate)},I.prototype.map=function(t){return new I(this.gen,S.of(t).compose(this.mapFunction).get(),this.filterPredicate)},I.prototype.reduce=function(t,e){for(var r=this;r.hasNext();){let n=r.head();t=e(t,r.mapFunction(n)),r=r.tail()}return t},I.prototype.forEach=function(t){for(var e=this;e.hasNext();){let r=e.head();t(e.mapFunction(r)),e=e.tail()}},I.prototype.collect=function(t){return this.reduce(t.identity,t.reduce)},I.prototype.filter=function(t){return new I(this.gen,this.mapFunction,e=>this.filterPredicate(e)&&t(e))},I.prototype.take=function(t){return new I(I.generatorOf({i:0,stream:this},t=>({i:t.i+1,stream:t.stream.tail()}),t=>t.stream.head(),e=>e.stream.hasNext()&&e.i<t),this.mapFunction,this.filterPredicate).collect(I.Collectors.toArray())},I.prototype.takeWhile=function(t){return new I(I.generatorOf(this,t=>t.tail(),t=>t.head(),e=>e.hasNext()&&t(e.head())),this.mapFunction,this.filterPredicate).collect(I.Collectors.toArray())},I.prototype.zip=function(t){return new I(I.generatorOf([this,t],t=>[t[0].tail(),t[1].tail()],t=>[t[0].head(),t[1].head()],t=>t[0].hasNext()&&t[1].hasNext()))},I.prototype.flatMap=function(t){return new I(I.generatorOf({baseStream:this,flatStream:null},e=>{if(!e.flatStream||!e.flatStream.hasNext()){let r=e.baseStream;return{baseStream:r.tail(),flatStream:t(r.head()).tail()}}return{baseStream:e.baseStream,flatStream:e.flatStream.tail()}},e=>e.flatStream&&e.flatStream.hasNext()?e.flatStream.head():t(e.baseStream.head()).head(),e=>e.flatStream?e.baseStream.hasNext()||e.flatStream.hasNext():e.baseStream.hasNext()&&t(e.baseStream.head()).hasNext()))},I.ofHeadTail=function(t,e){return new I(I.generatorOf({h:t,supplier:e},t=>{let e=t.supplier();return e.hasNext()?{h:e.head(),supplier:()=>e.tail()}:{h:null,supplier:null}},t=>t.h,t=>null!=t.h))},I.of=function(t){var e=[{name:"Array",predicate:t=>t.constructor===Array},{name:"Generator",predicate:t=>"function"==typeof t.hasNext&&"function"==typeof t.next&&"function"==typeof t.peek},{name:"Stream",predicate:t=>t.__proto__==I.prototype}],r={Array:t=>new I(I.generatorOf({i:0,array:t},t=>({i:t.i+1,array:t.array}),t=>t.array[t.i],t=>t.i<t.array.length)),Generator:t=>new I(t),Stream:t=>new I(t.gen,t.mapFunction,t.filterPredicate)};for(let n=0;n<e.length;n++)if(e[n].predicate(t))return r[e[n].name](t);throw`Iterable ${t} does not have a stream`},I.range=function(t,e,r=1){return new I(I.generatorOf(t,t=>t+r,t=>t,t=>null==e||t<e))},I.generatorOf=function(t,e,r,n){return new function(){this.state=t,this.next=e,this.peek=r,this.hasNext=n}},I.Collectors={toArray:()=>new function(){this.identity=[],this.reduce=(t,e)=>(t.push(e),t)}};var b=I,A={concat:function(t,e){return t.concat(e)},arrayEquals:function(t,e){if(t.length!=e.length)return!1;for(var r=0;r<t.length;r++)if(t[r]!=e[r])return!1;return!0},permute:function(t,e){for(var r=t.slice(),n=Math.min(t.length,e.length),i=0;i<n;i++)r[e[i]]=t[i];return r},randomPermute:function(t){const e=[...t];for(let r=t.length-1;r>0;r--){const t=Math.floor(Math.random()*(r+1)),n=e[r];e[r]=e[t],e[t]=n}return e},swap:function(t,e,r){var n=t[e];return t[e]=t[r],t[r]=n,t},findJsArrayDim:function(t){return t instanceof Array?A.concat(A.findJsArrayDim(t[0]),[t.length]):[]},unpackJsArray:function(t){if(t instanceof Array){for(var e=[],r=0;r<t.length;r++)e=A.concat(e,A.unpackJsArray(t[r]));return e}return[t]},range:function(t,e,r=1){for(var n=[],i=t;i<e;i+=r)n.push(i);return n},binaryOp:function(t,e,r){var n=t.length<e.length?t.slice():e.slice();for(let i=0;i<n.length;i++)n[i]=r(t[i],e[i]);return n},map:function(t,e){const r=[];for(let n=0;n<t.length;n++)r.push(e(t[n],n));return r},filter:function(t,e){const r=[];for(let n=0;n<t.length;n++)e(t[n],n)&&r.push(t[n]);return r},forEach:function(t,e){for(let r=0;r<t.length;r++)e(t[r],r)}},N=A;const C={};function D(t,e,r){if(e>=0&&e<t.length&&r>=0&&r<t.length){var n=t[e];t[e]=t[r],t[r]=n}}C.quicksort=function(t,e=((t,e)=>t-e)){const r=t.length,n=[...t],i=[];for(i.push(0),i.push(r-1);i.length>0;){const t=i.pop(),r=i.pop();if(r<t){const a=r+Math.floor((t-r)*Math.random()),o=n[a];D(n,a,t);let s=r;for(let i=r;i<t;i++)e(n[i],o)<=0&&(D(n,i,s),s++);D(n,s,t),i.push(r),i.push(s-1),i.push(s+1),i.push(t)}}return n},C.REVERSE_SORT_COMPARATOR=(t,e)=>e-t;var M=C;const O=function(t,e){if(this.dim=t,this.powers=[],this.denseNDArray=[],this.powers=P(t),void 0===e)for(let t=0;t<this.powers[this.powers.length-1];t++)this.denseNDArray[t]=null;else{if(e.length!=this.powers[this.powers.length-1])throw"Shape/dim doesn't agree with size "+t;this.denseNDArray=e.slice()}};function P(t){const e=[];let r=1;e[0]=r;for(let n=0;n<t.length;n++)r*=t[n],e[n+1]=r;return e}function T(t,e){if(t==e)return t;if(1==t||1==e)return t*e;throw"values are not one and they are different "}function E(t,e){const r=t.shape(),n=[];for(let t=0;t<r.length;t++)n.unshift(1==r[r.length-1-t]?0:e[e.length-1-t]);return 0==n.length?n.concat(0):n}O.prototype.size=function(){return this.powers[this.powers.length-1]},O.prototype.shape=function(){return this.dim},O.prototype.get=function(t){if(null==t)return this.denseNDArray[0];if("number"==typeof t)return this.get([t]);if(t.constructor===Array)return this.checkIfIndexOutOfBounds(t),this.checkIfCoordSizeCompatible(t.length),this.denseNDArray[this.getIndex(t)];if(t.constructor===String){const e=this.getIntervalFromStr(t),r=this.computeNewDim(e);if(0==r.length){const t=[];for(let r=0;r<e.length;r++)t.push(e[r][0]);return this.get(t)}const n=new O(r),i=n.size(),a=[],o=[];for(let t=0;t<e.length;t++)o[t]=e[t][1]-e[t][0]+1;const s=P(o);for(let t=0;t<i;t++){let r=0;for(let n=0;n<e.length;n++){const i=Math.floor(t%s[r+1]/s[r]);a[n]=e[n][0]+i,r++}n.denseNDArray[t]=this.get(a)}return n}throw"method 'get' only accepts strings and integer arrays"},O.prototype.set=function(t,e){if("number"==typeof t&&e.constructor!==Array)return this.set([t],e);if(t.constructor===Array&&e.constructor!==Array)return this.checkIfIndexOutOfBounds(t),this.checkIfCoordSizeCompatible(t.length),this.denseNDArray[this.getIndex(t)]=e,this;if(t.constructor===String&&e.constructor===O){const r=this.getIntervalFromStr(t),n=e.size(),i=[],a=[];for(let t=0;t<r.length;t++)a[t]=r[t][1]-r[t][0]+1;const o=P(a);for(let t=0;t<n;t++){let n=0;for(let e=0;e<r.length;e++){const a=Math.floor(t%o[n+1]/o[n]);i[e]=r[e][0]+a,n++}this.set(i,e.denseNDArray[t])}return this}throw"set only accepts strings and integer arrays as the first argument and objects and DenseNDArray as the second"},O.prototype.map=function(t){const e=this.copy(),r=this.size();for(let n=0;n<r;n++)e.denseNDArray[n]=t(this.denseNDArray[n]);return e},O.prototype.mapWithIndex=function(t){const e=this.copy(),r=this.size(),n=this.dim,i=this.powers,a=[];for(let o=0;o<r;o++){for(let t=0;t<n.length;t++)a[t]=Math.floor(o%i[t+1]/i[t]);e.denseNDArray[o]=t(this.denseNDArray[o],a)}return e},O.prototype.reduce=function(t,e){const r=this.size();for(let n=0;n<r;n++)t=e(t,this.denseNDArray[n]);return t},O.prototype.forEach=function(t){this.denseNDArray.forEach(t)},O.prototype.transform=function(t){const e=this.size();for(let r=0;r<e;r++)this.denseNDArray[r]=t(this.denseNDArray[r]);return this},O.prototype.transformWithIndex=function(t){const e=this.size(),r=this.dim,n=this.powers,i=[];for(let a=0;a<e;a++){for(let t=0;t<r.length;t++)i[t]=Math.floor(a%n[t+1]/n[t]);this.denseNDArray[a]=t(this.denseNDArray[a],i)}return this},O.prototype.toArray=function(){return this.toArrayRecursive([])},O.prototype.toArrayRecursive=function(t){const e=[],r=t.length;if(r!=this.dim.length){for(let n=0;n<this.dim[this.dim.length-1-r];n++)e.push(this.toArrayRecursive(N.concat([n],t)));return e}return this.get(t)},O.prototype.toString=function(){return this.toStringRecursive([])},O.prototype.toStringRecursive=function(t){const e=[],r=t.length;if(r!=this.dim.length){e.push("[");for(let n=0;n<this.dim[this.dim.length-1-r];n++)e.push(this.toStringRecursive(N.concat([n],t)));e.push("]")}else e.push(this.get(t)+", ");return e.join("")},O.prototype.copy=function(){return O.of(this.denseNDArray,this.dim)},O.prototype.equals=function(t){return this==t||null!=t&&this.prototype==t.prototype&&(N.arrayEquals(this.denseNDArray,t.denseNDArray)&&N.arrayEquals(this.powers,t.powers)&&N.arrayEquals(this.dim,t.dim))},O.prototype.hashCode=function(){throw"To be implemented in near future"},O.prototype.getIndex=function(t){let e=0;const r=Math.min(t.length,this.dim.length);for(let n=0;n<r;n++)e+=t[t.length-n-1]*this.powers[this.dim.length-n-1];return e},O.prototype.computeNewDim=function(t){const e=[];for(let r=0;r<t.length;r++){const n=t[r][1]-t[r][0];0!==n&&e.push(n+1)}const r=[];for(let t=0;t<e.length;t++)r[t]=e[t];return r},O.prototype.getIntervalFromStr=function(t){const e=t.split(" ").join("").split(",");this.checkIfCoordSizeCompatible(e.length);const r=[];for(let t=0;t<e.length;t++){const n=e[t].split(":");({1:()=>{const e=parseInt(n[0]);r[t]=[e,e]},2:()=>{const e=Math.max(0,Math.min(this.dim[t]-1,""==n[0]?0:parseInt(n[0]))),i=Math.max(0,Math.min(this.dim[t]-1,""==n[1]?this.dim[t]-1:parseInt(n[1]))),a=[e,i];if(i-e==0)throw`empty interval xmax : ${i} < xmin : ${e}`;r[t]=a}})[n.length]()}return r},O.prototype.checkIfIndexOutOfBounds=function(t){let e=0==this.dim.length&&t[0]>0,r=0!=this.dim.length&&N.binaryOp(t,this.dim,(t,e)=>t>=0&&t<e?0:1).reduce((t,e)=>t+e)>0;if(e||r)throw`index out of bounds ${t}, actual shape is ${this.dim}`},O.prototype.checkIfCoordSizeCompatible=function(t){if(0!=this.dim.length&&t>this.dim.length)throw`Size dimension incorrect : ${t}. Correct size dimension should be less or equal ${this.dim.length}`},O.prototype.reshape=function(t){return O.of(this,t)},O.prototype.binaryOp=function(t,e){const r=this.shape(),n="number"==typeof t?O.of(t):t,i=n.shape(),a=r.length<i.length?r:i,o=r.length<i.length?i:r;let s=[];for(let t=0;t<a.length;t++)try{s.push(T(a[a.length-t-1],o[o.length-t-1]))}catch(t){throw`Dimensions ${r} and ${i} are not compatible for broadcast`}for(let t=a.length;t<o.length;t++)s.push(o[o.length-t-1]);return s=s.reverse(),new O(s).transformWithIndex((t,r)=>{let i=this.get(E(this,r)),a=n.get(E(n,r));return e(i,a)})},O.of=function(t,e){return t instanceof O?new O(void 0===e?t.dim:e,t.denseNDArray):function(t){return t.length>0&&void 0===t[0].length}(t)?t.length>0&&void 0===e?new O([t.length],t):new O(e,t):function(t){const e=N.findJsArrayDim(t),r=N.unpackJsArray(t);return O.of(r,e)}(t)};const R={distanceFactory:(t=1,e=1,r=1)=>(n,i)=>{const a=n.length,o=i.length,s=k(a+1,o+1);for(let t=0;t<a+1;t++)s[t][0]=t;for(let t=0;t<a+1;t++)s[0][t]=t;for(let h=1;h<a+1;h++)for(let a=1;a<o+1;a++){const o=n[h-1]===i[a-1],c=s[h-1][a]+e,u=s[h][a-1]+r,l=s[h-1][a-1]+(o?0:t);s[h][a]=_(c,u,l)}return s[a][o]}};R.distance=R.distanceFactory();const k=(t,e)=>Array.from(Array(t),()=>new Array(e)),_=(...t)=>t.reduce((t,e)=>Math.min(t,e),Number.MAX_VALUE);var L=R}])}));