!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Nabla=e():t.Nabla=e()}(window,(function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,r){"use strict";r.r(e),r.d(e,"Canvas",(function(){return d})),r.d(e,"Canvas2D",(function(){return w})),r.d(e,"ImageIO",(function(){return i})),r.d(e,"DenseNDArray",(function(){return St})),r.d(e,"Stream",(function(){return x})),r.d(e,"ArrayUtils",(function(){return E})),r.d(e,"Sort",(function(){return _})),r.d(e,"EditDistance",(function(){return P})),r.d(e,"DVector",(function(){return J})),r.d(e,"Pair",(function(){return at})),r.d(e,"List",(function(){return gt}));var n={getImageCanvas:function(t){var e=document.createElement("canvas");e.width=t.width,e.height=t.height;var r=e.getContext("2d");return r.fillStyle="rgba(0, 0, 0, 0)",r.globalCompositeOperation="source-over",r.fillRect(0,0,e.width,e.height),r.drawImage(t,0,0),e},getDataFromImage:function(t){return canvas=n.getImageCanvas(t),canvas.getContext("2d").getImageData(0,0,t.width,t.height)},loadImage:function(t){var e=new Image;return e.src=t,e.isReady=!1,e.onload=function(){return e.isReady=!0},e},generateImageReadyPredicate:function(t){return function(){return t.isReady}}},i=n;function a(t,e){var r=[];return r[0]=t[0]+e[0],r[1]=t[1]+e[1],r}function o(t){var e=[];return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e}function u(t,e){var r=[];return r[0]=t[0]-e[0],r[1]=t[1]-e[1],r}function s(t,e){return t[0]*e[0]+t[1]*e[1]}function c(t){return s(t,t)}function h(t){return Math.sqrt(s(t,t))}function f(t,e){var r=[];return r[0]=Math.min(t[0],e[0]),r[1]=Math.min(t[1],e[1]),r}function l(t,e){var r=[];return r[0]=Math.max(t[0],e[0]),r[1]=Math.max(t[1],e[1]),r}function p(t,e,r){var n=r[1]/t[1];return[n,(-t[0]*n+r[0])/e]}function v(t,e,r){var n=r[0]/t[0];return[n,(-t[1]*n+r[1])/e]}var g,y=function(t){this.canvas=t,this.ctx=t.getContext("2d"),this.image=this.ctx.getImageData(0,0,t.width,t.height),this.imageData=this.image.data};y.prototype.getSize=function(){return[this.canvas.height,this.canvas.width]},y.prototype.paintImage=function(){this.ctx.putImageData(this.image,0,0)},y.prototype.getCanvas=function(){return this.canvas},y.prototype.clearImage=function(t){this.useCanvasCtx((function(e){var r=e.getSize();e.ctx.fillStyle="rgba("+t[0]+","+t[1]+","+t[2]+","+t[3]+")",e.ctx.globalCompositeOperation="source-over",e.ctx.fillRect(0,0,r[1],r[0])}),!0)},y.prototype.useCanvasCtx=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e||this.ctx.putImageData(this.image,0,0),t(this),this.image=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height),this.imageData=this.image.data},y.prototype.getImageIndex=function(t){return 4*(this.canvas.width*t[0]+t[1])},y.prototype.getPxl=function(t){var e=this.getImageIndex(t);return[this.imageData[e],this.imageData[e+1],this.imageData[e+2],this.imageData[e+3]]},y.prototype.drawPxl=function(t,e){var r=this.getImageIndex(t);this.imageData[r]=e[0],this.imageData[r+1]=e[1],this.imageData[r+2]=e[2],this.imageData[r+3]=e[3]},y.prototype.drawLine=function(t,e,r){r.points=[t,e];var n=[];n.push(t),n.push(e);for(var i=[],a=[],o=0;o<n.length;o++){0<=(l=n[o])[0]&&l[0]<this.canvas.height&&0<=l[1]&&l[1]<this.canvas.width?i.push(l):a.push(l)}if(2!=i.length){var c=[],h=[e[0]-t[0],e[1]-t[1]];c.push(p(h,-(this.canvas.height-1),[-t[0],-t[1]])),c.push(v(h,-(this.canvas.width-1),[this.canvas.height-1-t[0],-t[1]])),c.push(p(h,this.canvas.height-1,[this.canvas.height-1-t[0],this.canvas.width-1-t[1]])),c.push(v(h,this.canvas.width-1,[-t[0],this.canvas.width-1-t[1]]));var f=[];for(o=0;o<c.length;o++){var l;0<=(l=c[o])[0]&&l[0]<=1&&0<=l[1]&&l[1]<=1&&f.push(l)}if(0!=f.length)if(i.length>0){var g=[t[0]+f[0][0]*h[0],t[1]+f[0][0]*h[1]];this.drawLineInt(i.pop(),g,r)}else{var y=[t[0]+f[0][0]*h[0],t[1]+f[0][0]*h[1]];for(o=1;o<f.length;o++){if(s(h=u(g=[t[0]+f[o][0]*h[0],t[1]+f[o][0]*h[1]],y),h)>.001)return void this.drawLineInt(y,g,r)}this.drawLineInt(y,y,r)}}else this.drawLineInt(i[0],i[1],r)},y.prototype.drawLineInt=function(t,e,r){t=o(t),e=o(e);var n=[-1,0,1],i=n.length,c=i*i,h=[];h[0]=t[0],h[1]=t[1];var f=u(e,t),l=[];for(l[0]=-f[1],l[1]=f[0],r(h,r.points,this);h[0]!==e[0]||h[1]!==e[1];){for(var p=Number.MAX_VALUE,v=[],g=0;g<c;g++){var y=n[g%i],d=n[Math.floor(g/i)],m=u(a(h,[y,d]),t),w=Math.abs(s(m,l))-s(m,f);p>w&&(p=w,v=[y,d])}r(h=a(h,v),r.points,this)}r(h,r.points,this)},y.prototype.drawPolygon=function(t,e){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:y.isInsidePolygon,n=[[Number.MAX_VALUE,Number.MAX_VALUE],[Number.MIN_VALUE,Number.MIN_VALUE]],i=0;i<t.length;i++)n[0]=f(t[i],n[0]),n[1]=l(t[i],n[1]);var a=this.getSize(),s=u(a,[1,1]),c=[0,0];n[0]=o(f(s,l(c,n[0]))),n[1]=o(f(s,l(c,n[1])));for(var h=n[0][0];h<n[1][0];h++)for(var p=n[0][1];p<n[1][1];p++){var v=[h,p];r(v,t)&&e(v,t,this)}},y.prototype.drawTriangle=function(t,e,r,n){var i=[t,e,r];this.drawPolygon(i,n,y.isInsideConvex)},y.prototype.drawQuad=function(t,e,r,n,i){this.drawPolygon([t,e,r,n],i)},y.prototype.drawImage=function(t,e){"isReady"in t&&!t.isReady||this.useCanvasCtx((function(r){return r.ctx.drawImage(t,e[1],e[0])}))},y.prototype.drawCircle=function(t,e,r){var n=function(t,e){var r=[];return r[0]=t[0]*e,r[1]=t[1]*e,r}([1,1],e),i=[u(t,n),a(t,n)],s=this.getSize();i[0]=o(f(u(s,[1,1]),l([0,0],i[0]))),i[1]=o(f(u(s,[1,1]),l([0,0],i[1])));for(var c=i[0][0];c<=i[1][0];c++)for(var h=i[0][1];h<=i[1][1];h++){var p=[c,h];this.isInsideCircle(p,t,e)&&r(p,[t,e],this)}},y.prototype.isInsideCircle=function(t,e,r){return c(u(t,e))<=r*r},y.prototype.addEventListener=function(t,e,r){this.canvas.addEventListener(t,e,r)},y.prototype.drawString=function(t,e,r){this.useCanvasCtx((function(n){r(n.ctx),n.ctx.fillText(e,t[1],t[0])}))},y.isInsidePolygon=function(t,e){for(var r=[],n=0,i=e.length,a=0;a<i;a++)r[0]=u(e[(a+1)%i],t),r[1]=u(e[a],t),n+=Math.acos(s(r[0],r[1])/(h(r[0])*h(r[1])));return Math.abs(n-2*Math.PI)<.001},y.isInsideConvex=function(t,e){for(var r=e.length,n=[],i=[],a=0;a<r;a++){n[a]=u(e[(a+1)%r],e[a]);var o=[-n[a][1],n[a][0]],c=u(t,e[a]);i[a]=s(c,o)}var h=n[0][0]*n[1][1]-n[0][1]*n[1][0]>0?1:-1;for(a=0;a<r;a++){if(i[a]*h<0)return!1}return!0},y.simpleShader=function(t){return function(e,r,n){return n.drawPxl(e,t)}},y.colorShader=function(t){return y.interpolateTriangleShader((function(e,r,n,i){for(var a=[0,0,0,0],o=0;o<r.length;o++)a[0]=a[0]+t[o][0]*i[o],a[1]=a[1]+t[o][1]*i[o],a[2]=a[2]+t[o][2]*i[o],a[3]=a[3]+t[o][3]*i[o];n.drawPxl(e,a)}))},y.interpolateQuadShader=function(t){return function(e,r,n){var i=[r[0],r[1],r[2]],a=[r[2],r[3],r[0]],o=y.triangleBaryCoord(e,i);o[0]>0&&o[1]>0&&o[2]>0&&Math.abs(o[0]+o[1]+o[2]-1)<1e-10?t(e,r,n,[o[0],o[1],o[2],0]):(o=y.triangleBaryCoord(e,a),t(e,r,n,[o[2],0,o[0],o[1]]))}},y.interpolateTriangleShader=function(t){return function(e,r,n){alpha=y.triangleBaryCoord(e,r),t(e,r,n,alpha)}},y.interpolateLineShader=function(t){return function(e,r,n){var i=u(r[1],r[0]),a=u(e,r[0]),o=c(i),h=s(a,i);t(e,r,n,0==o?0:h/o)}},y.quadTextureShader=function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:y.bilinearInterpolation,n=null,s=function(s,c,h,p){t.isReady&&null!=n||(n=new y(i.getImageCanvas(t)));for(var v=n,g=v.getSize(),d=[0,0],m=0;m<e.length;m++)d[0]=d[0]+e[m][0]*p[m],d[1]=d[1]+e[m][1]*p[m];var w=[(1-d[1])*(g[1]-1),(g[0]-1)*d[0]],b=o(w=l([0,0],f(u([g[0],g[1]],[1,1]),w))),S=[v.getPxl(b),v.getPxl(a(b,[1,0])),v.getPxl(a(b,[1,1])),v.getPxl(a(b,[0,1]))],A=r(S,u(w,b));h.drawPxl(s,A)};return y.interpolateQuadShader(s)},y.triangleCache=(g=[],{constains:function(t){return null!=g[t%3]},get:function(t){return g[t%3]},set:function(t,e){return g[t%3]=e}}),y.triangleHash=function(t){return[t[0][0],t[1][0],t[2][0],t[0][1],t[1][1],t[2][1]].reduce((function(t,e){return 31*t+e}),1)},y.triangleBaryCoord=function(t,e){var r=y.triangleHash(e),n=[t[0]-e[0][0],t[1]-e[0][1]];if(!y.triangleCache.constains(r)){var i=[e[1][0]-e[0][0],e[1][1]-e[0][1]],a=[e[2][0]-e[0][0],e[2][1]-e[0][1]],o=i[0]*a[1]-i[1]*a[0];y.triangleCache.set(r,{triangle:e,u:i.map((function(t){return t/o})),v:a.map((function(t){return t/o})),det:o,hash:r})}var u=y.triangleCache.get(r),s=u.u,c=u.v;if(0==u.det)return[0,0,0];var h=[c[1]*n[0]-c[0]*n[1],s[0]*n[1]-s[1]*n[0]];return[1-h[0]-h[1],h[0],h[1]]},y.bilinearInterpolation=function(t,e){for(var r=[],n=0;n<t.length;n++){var i=t[0][n]+(t[3][n]-t[0][n])*e[1],a=i+(t[1][n]+(t[2][n]-t[1][n])*e[1]-i)*e[0];r.push(a)}return r},y.createCanvas=function(t,e){var r=document.createElement("canvas");return r.setAttribute("width",t[0]),r.setAttribute("height",t[1]),document.getElementById(e).appendChild(r),r};var d=y,m=function(t,e){if(d.call(this,t),2!=e.length||2!=e[0].length&&2!=e[1].length)throw"camera space must be 2-dim array with 2-dim arrays representing an interval";this.cameraSpace=e};(m.prototype=Object.create(d.prototype)).constructor=m,m.prototype.integerTransform=function(t){return[-(this.canvas.height-1)/(this.cameraSpace[1][1]-this.cameraSpace[1][0])*(t[1]-this.cameraSpace[1][1]),(this.canvas.width-1)/(this.cameraSpace[0][1]-this.cameraSpace[0][0])*(t[0]-this.cameraSpace[0][0])]},m.prototype.inverseTransform=function(t){return[this.cameraSpace[0][0]+(this.cameraSpace[0][1]-this.cameraSpace[0][0])/(this.canvas.width-1)*t[1],this.cameraSpace[1][1]-(this.cameraSpace[1][1]-this.cameraSpace[1][0])/(this.canvas.height-1)*t[0]]},m.prototype.drawLine=function(t,e,r){var n=this.integerTransform(t),i=this.integerTransform(e);d.prototype.drawLine.call(this,n,i,r)},m.prototype.drawTriangle=function(t,e,r,n){var i=this.integerTransform(t),a=this.integerTransform(e),o=this.integerTransform(r);d.prototype.drawTriangle.call(this,i,a,o,n)},m.prototype.drawQuad=function(t,e,r,n,i){var a=this.integerTransform(t),o=this.integerTransform(e),u=this.integerTransform(r),s=this.integerTransform(n);d.prototype.drawQuad.call(this,a,o,u,s,i)},m.prototype.drawCircle=function(t,e,r){var n=this.integerTransform(t),i=this.integerTransform([e,0])[1]-this.integerTransform([0,0])[1];d.prototype.drawCircle.call(this,n,i,r)},m.prototype.drawImage=function(t,e){d.prototype.drawImage.call(this,t,this.integerTransform(e))},m.prototype.drawString=function(t,e,r){var n=this.integerTransform(t);d.prototype.drawString.call(this,n,e,r)},m.prototype.setCamera=function(t){if(2!=t.length||2!=t[0].length&&2!=t[1].length)throw"camera space must be 2-dim array with 2-dim arrays representing an interval";this.cameraSpace=t};var w=m,b=function(t){this.f=t};b.prototype.compose=function(t){var e=this;return new b((function(r){return e.f(t(r))}))},b.prototype.leftCompose=function(t){var e=this;return new b((function(r){return t(e.f(r))}))},b.prototype.apply=function(t){return this.f(t)},b.prototype.get=function(){return this.f},b.of=function(t){return new b(t)};var S=b,A=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(t){return!0};this.gen=t,this.mapFunction=e,this.filterPredicate=r};A.prototype.state=function(){return this.gen.state},A.prototype.hasNext=function(){return this.gen.hasNext(this.filteredState())},A.prototype.filteredState=function(){for(var t=this.state();this.gen.hasNext(t)&&!this.filterPredicate(this.gen.peek(t));)t=this.gen.next(t);return t},A.prototype.head=function(){var t=this.filteredState();if(this.gen.hasNext(t))return this.gen.peek(t);throw"No head element exception"},A.prototype.tail=function(){return new A(A.generatorOf(this.gen.next(this.filteredState()),this.gen.next,this.gen.peek,this.gen.hasNext),this.mapFunction,this.filterPredicate)},A.prototype.map=function(t){return new A(this.gen,S.of(t).compose(this.mapFunction).get(),this.filterPredicate)},A.prototype.reduce=function(t,e){for(var r=this;r.hasNext();){var n=r.head();t=e(t,r.mapFunction(n)),r=r.tail()}return t},A.prototype.forEach=function(t){for(var e=this;e.hasNext();){var r=e.head();t(e.mapFunction(r)),e=e.tail()}},A.prototype.collect=function(t){return this.reduce(t.identity,t.reduce)},A.prototype.filter=function(t){var e=this;return new A(this.gen,this.mapFunction,(function(r){return e.filterPredicate(r)&&t(r)}))},A.prototype.take=function(t){return new A(A.generatorOf({i:0,stream:this},(function(t){return{i:t.i+1,stream:t.stream.tail()}}),(function(t){return t.stream.head()}),(function(e){return e.stream.hasNext()&&e.i<t})),this.mapFunction,this.filterPredicate).collect(A.Collectors.toArray())},A.prototype.takeWhile=function(t){return new A(A.generatorOf(this,(function(t){return t.tail()}),(function(t){return t.head()}),(function(e){return e.hasNext()&&t(e.head())})),this.mapFunction,this.filterPredicate).collect(A.Collectors.toArray())},A.prototype.zip=function(t){return new A(A.generatorOf([this,t],(function(t){return[t[0].tail(),t[1].tail()]}),(function(t){return[t[0].head(),t[1].head()]}),(function(t){return t[0].hasNext()&&t[1].hasNext()})))},A.prototype.flatMap=function(t){return new A(A.generatorOf({baseStream:this,flatStream:null},(function(e){if(!e.flatStream||!e.flatStream.hasNext()){var r=e.baseStream;return{baseStream:r.tail(),flatStream:t(r.head()).tail()}}return{baseStream:e.baseStream,flatStream:e.flatStream.tail()}}),(function(e){return e.flatStream&&e.flatStream.hasNext()?e.flatStream.head():t(e.baseStream.head()).head()}),(function(e){return e.flatStream?e.baseStream.hasNext()||e.flatStream.hasNext():e.baseStream.hasNext()&&t(e.baseStream.head()).hasNext()})))},A.ofHeadTail=function(t,e){return new A(A.generatorOf({h:t,supplier:e},(function(t){var e=t.supplier();return e.hasNext()?{h:e.head(),supplier:function(){return e.tail()}}:{h:null,supplier:null}}),(function(t){return t.h}),(function(t){return null!=t.h})))},A.of=function(t){for(var e=[{name:"Array",predicate:function(t){return t.constructor===Array}},{name:"Generator",predicate:function(t){return"function"==typeof t.hasNext&&"function"==typeof t.next&&"function"==typeof t.peek}},{name:"Stream",predicate:function(t){return t.__proto__==A.prototype}}],r={Array:function(t){return new A(A.generatorOf({i:0,array:t},(function(t){return{i:t.i+1,array:t.array}}),(function(t){return t.array[t.i]}),(function(t){return t.i<t.array.length})))},Generator:function(t){return new A(t)},Stream:function(t){return new A(t.gen,t.mapFunction,t.filterPredicate)}},n=0;n<e.length;n++)if(e[n].predicate(t))return r[e[n].name](t);throw"Iterable ".concat(t," does not have a stream")},A.range=function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return new A(A.generatorOf(t,(function(t){return t+r}),(function(t){return t}),(function(t){return null==e||t<e})))},A.generatorOf=function(t,e,r,n){return new function(){this.state=t,this.next=e,this.peek=r,this.hasNext=n}},A.Collectors={toArray:function(){return new function(){this.identity=[],this.reduce=function(t,e){return t.push(e),t}}}};var x=A;function k(t){return function(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var I={arrayEquals:function(t,e){if(!(t instanceof Array))return!1;if(!(e instanceof Array))return!1;if(t.length!=e.length)return!1;for(var r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0},permute:function(t,e){for(var r=t.slice(),n=Math.min(t.length,e.length),i=0;i<n;i++)r[e[i]]=t[i];return r},shuffle:function(t){for(var e=k(t),r=t.length-1;r>0;r--){var n=Math.floor(Math.random()*(r+1)),i=e[r];e[r]=e[n],e[n]=i}return e},swap:function(t,e,r){var n=k(t),i=n[e];return n[e]=n[r],n[r]=i,n},findJsArrayDim:function(t){return t instanceof Array?I.findJsArrayDim(t[0]).concat([t.length]):[]},unpackJsArray:function(t){if(!(t instanceof Array))return[t];for(var e=[],r=0;r<t.length;r++)e=e.concat(I.unpackJsArray(t[r]));return e},range:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=[];if(t>=e)return n;for(var i=t;i<e;i+=r)n.push(i);return n}}};I.range0=I.range(),I.binaryOp=function(t,e,r){for(var n=t.length<e.length?t.slice():e.slice(),i=0;i<n.length;i++)n[i]=r(t[i],e[i]);return n},I.groupBy=function(t,e){var r={};return t.forEach((function(t){var n=e(t);r[n]||(r[n]=[]),r[n].push(t)})),r};var E=I;function O(t){return function(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var N={};function D(t,e,r){if(e>=0&&e<t.length&&r>=0&&r<t.length){var n=t[e];t[e]=t[r],t[r]=n}}N.quicksort=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t,e){return t-e},r=t.length,n=O(t),i=[];for(i.push(0),i.push(r-1);i.length>0;){var a=i.pop(),o=i.pop();if(o<a){var u=o+Math.floor((a-o)*Math.random()),s=n[u];D(n,u,a);for(var c=o,h=o;h<a;h++)e(n[h],s)<=0&&(D(n,h,c),c++);D(n,c,a),i.push(o),i.push(c-1),i.push(c+1),i.push(a)}}return n},N.REVERSE_SORT_COMPARATOR=function(t,e){return e-t};var _=N,C={distanceFactory:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return function(n,i){for(var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(t){},o=n.length,u=i.length,s=T(o+1,u+1),c=0;c<o+1;c++)s[c][0]=c*e;for(var h=0;h<u+1;h++)s[0][h]=h*r;for(var f=1;f<o+1;f++)for(var l=1;l<u+1;l++){var p=n[f-1]===i[l-1],v=s[f-1][l]+e,g=s[f][l-1]+r,y=s[f-1][l-1]+(p?0:t);s[f][l]=M(v,g,y)}return a(s,n,i),s[o][u]}}};C.distance=C.distanceFactory(),C.printDistanceMatrix=function(t,e,r){var n=[];t.forEach((function(t,e){var r=[];t.forEach((function(t,e){return r.push("".concat(t))})),n.push(r.join(" "))})),console.log("w1: ".concat(e,", w2: ").concat(r,"\n"),n.join("\n"))};var T=function(t,e){return Array.from(Array(t),(function(){return new Array(e)}))},M=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return e.reduce((function(t,e){return Math.min(t,e)}),Number.MAX_VALUE)},P=C;function j(t){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function R(t,e){return!e||"object"!==j(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function L(t){var e="function"==typeof Map?new Map:void 0;return(L=function(t){if(null===t||(r=t,-1===Function.toString.call(r).indexOf("[native code]")))return t;var r;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return F(t,arguments,B(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),q(n,t)})(t)}function z(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function F(t,e,r){return(F=z()?Reflect.construct:function(t,e,r){var n=[null];n.push.apply(n,e);var i=new(Function.bind.apply(t,n));return r&&q(i,r.prototype),i}).apply(null,arguments)}function q(t,e){return(q=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function B(t){return(B=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function V(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function W(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function U(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var J=function(){function t(e){var r=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];V(this,t),U(this,"size",(function(){return r._n})),U(this,"shape",(function(){return[r._n]})),U(this,"fold",this.reduce),U(this,"foldLeft",this.fold),n?(this._vec=e,this._n=this._vec.length):(this._vec=Q(e.length),G(e,this._vec),this._n=this._vec.length)}var e,r,n;return e=t,n=[{key:"fromArray",value:function(e){return new t(e)}},{key:"of",value:function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new t(r)}}],(r=[{key:"copy",value:function(){return new t(X(this._vec),!0)}},{key:"get",value:function(t){return this._vec[t]}},{key:"toArray",value:function(){return X(this._vec)}},{key:"toString",value:function(){return"["+this._vec.join(", ")+"]"}},{key:"add",value:function(t){return this.op(t,(function(t,e){return t+e}))}},{key:"sub",value:function(t){return this.op(t,(function(t,e){return t-e}))}},{key:"mul",value:function(t){return this.op(t,(function(t,e){return t*e}))}},{key:"div",value:function(t){return this.op(t,(function(t,e){return t/e}))}},{key:"dot",value:function(t){for(var e=0,r=0;r<this._n;r++)e+=this._vec[r]*t._vec[r];return e}},{key:"squareLength",value:function(){return this.dot(this)}},{key:"length",value:function(){return Math.sqrt(this.dot(this))}},{key:"normalize",value:function(){return this.scale(1/this.length())}},{key:"scale",value:function(t){return this.map((function(e){return e*t}))}},{key:"map",value:function(e){for(var r=Q(this._n),n=0;n<this._n;n++)r[n]=e(this._vec[n],n);return new t(r,!0)}},{key:"op",value:function(e,r){!function(t,e){if(t.n===e.n)return!0;throw new H("Vector must have same size")}(this,e);for(var n=Q(this._n),i=0;i<this._n;i++)n[i]=r(this._vec[i],e._vec[i]);return new t(n,!0)}},{key:"reduce",value:function(t,e){for(var r=e,n=0;n<this._n;n++)r=t(r,this._vec[n],n);return r}},{key:"equals",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e-5;return e instanceof t&&this.sub(e).length()<r}},{key:"take",value:function(e){return new t(this._vec.slice(0,e))}},{key:"n",get:function(){return this._n}}])&&W(e.prototype,r),n&&W(e,n),t}();U(J,"ZERO",(function(t){return new J(Q(t),!0)})),U(J,"e",(function(t){return function(e){var r=Q(t);return e>=0&&e<t&&(r[e]=1),new J(r,!0)}}));var Q=function(t){return new Y.Float64Array(t)},X=function(t){return Y.Float64Array.from(t)},H=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&q(t,e)}(r,t);var e=function(t){function e(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}return function(){var r,n=B(t);if(e()){var i=B(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return R(this,r)}}(r);function r(){return V(this,r),e.apply(this,arguments)}return r}(L(Error)),Y={Float32Array:Float32Array,Float64Array:Float64Array};function G(t,e){for(var r=0;r<t.length;r++){var n=t[r],i=null!=n&&"number"==typeof n;e[r]=i?n:0}return e}function Z(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t))&&"[object Arguments]"!==Object.prototype.toString.call(t))return;var r=[],n=!0,i=!1,a=void 0;try{for(var o,u=t[Symbol.iterator]();!(n=(o=u.next()).done)&&(r.push(o.value),!e||r.length!==e);n=!0);}catch(t){i=!0,a=t}finally{try{n||null==u.return||u.return()}finally{if(i)throw a}}return r}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function K(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function tt(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function et(t,e){var r=e.get(t);if(!r)throw new TypeError("attempted to get private field on non-instance");return r.get?r.get.call(t):r.value}function rt(t,e,r){var n=e.get(t);if(!n)throw new TypeError("attempted to set private field on non-instance");if(n.set)n.set.call(t,r);else{if(!n.writable)throw new TypeError("attempted to set read only private field");n.value=r}return r}var nt=new WeakMap,it=new WeakMap,at=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;K(this,t),nt.set(this,{writable:!0,value:null}),it.set(this,{writable:!0,value:null}),tt(this,"key",this.left),tt(this,"val",this.right),tt(this,"first",this.left),tt(this,"second",this.right),tt(this,"car",this.left),tt(this,"cdr",this.right),tt(this,"fold",this.reduce),tt(this,"foldLeft",this.fold),rt(this,nt,e),rt(this,it,r)}var e,r,n;return e=t,n=[{key:"of",value:function(e,r){return new t(e,r)}},{key:"fromArray",value:function(e){var r=Z(e,2);return new t(r[0],r[1])}}],(r=[{key:"left",value:function(){return et(this,nt)}},{key:"right",value:function(){return et(this,it)}},{key:"map",value:function(e){return new t(e(et(this,nt)),e(et(this,it)))}},{key:"reduce",value:function(t,e){return t(t(e,et(this,nt)),et(this,it))}},{key:"op",value:function(e,r){return t.of(r(et(this,nt),et(e,nt)),r(et(this,it),et(e,it)))}},{key:"isEmpty",value:function(){return!et(this,nt)&&!et(this,it)}},{key:"toArray",value:function(){return[et(this,nt),et(this,it)]}},{key:"copy",value:function(){return new t(et(this,nt),et(this,it))}}])&&$(e.prototype,r),n&&$(e,n),t}();function ot(t){return function(t){if(Array.isArray(t))return t}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function ut(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function st(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ct(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ht(t,e){var r=e.get(t);if(!r)throw new TypeError("attempted to get private field on non-instance");return r.get?r.get.call(t):r.value}function ft(t,e,r){var n=e.get(t);if(!n)throw new TypeError("attempted to set private field on non-instance");if(n.set)n.set.call(t,r);else{if(!n.writable)throw new TypeError("attempted to set read only private field");n.value=r}return r}tt(at,"cons",at.of);var lt=new WeakMap,pt=new WeakMap,vt=new WeakMap,gt=function(){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.EMPTY_LIST;if(ut(this,t),lt.set(this,{writable:!0,value:new at}),pt.set(this,{writable:!0,value:null}),vt.set(this,{writable:!0,value:-1}),ct(this,"sum",this.concat),null==e)return this;ft(this,lt,new at(e,yt(r)?new t:r)),ft(this,pt,this.getLast())}var e,r,n;return e=t,n=[{key:"fromArray",value:function(e){var r=ot(e),n=r[0],i=r.slice(1);return n?new t(n,t.fromArray(i)):new t}},{key:"of",value:function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return t.fromArray(r)}},{key:"rangeTail",value:function(e,r,n,i){return e>=r?i:t.rangeTail(e+n,r,n,i.concat(new t(e)))}}],(r=[{key:"head",value:function(){return ht(this,lt).left()}},{key:"tail",value:function(){return ht(this,lt).right()}},{key:"concat",value:function(e){return this.isEmpty()?e:new t(this.head(),this.tail().concat(e))}},{key:"concatTail",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;return this.isEmpty()?t:t.isEmpty()?e:this.concatTail(t.tail(),e.push(t.head()))}},{key:"push",value:function(e){return this.isEmpty()?new t(e):new t(this.head(),this.tail().push(e))}},{key:"map",value:function(t){}},{key:"isEmpty",value:function(){return ht(this,lt).isEmpty()}},{key:"length",value:function(){return ht(this,vt)>=0?ht(this,vt):this.isEmpty()?0:(ft(this,vt,1+this.tail().length()),ht(this,vt))}},{key:"getLast",value:function(){return null!==ht(this,pt)?ht(this,pt):this.tail().isEmpty()?this:(ft(this,pt,this.tail().getLast()),ht(this,pt))}},{key:"toArray",value:function(){return this.isEmpty()?[]:[this.head()].concat(this.tail().toArray())}},{key:"toString",value:function(){return this.isEmpty()?"[]":"[".concat(this.toStringRecursive(),"]")}},{key:"toStringRecursive",value:function(){return this.isEmpty()?"":"".concat(this.head(),", ").concat(this.tail().toStringRecursive())}}])&&st(e.prototype,r),n&&st(e,n),t}();function yt(t){return!(t&&t instanceof gt)}ct(gt,"EMPTY_LIST",new gt),ct(gt,"range",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t<e?new gt(t,gt.range(t+r)(e,r)):gt.EMPTY_LIST}})),ct(gt,"range0",gt.range(0)),ct(gt,"rangeR",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return gt.rangeTail(t,e,r,new gt)}}));var dt=function(t,e){if(this.dim=t,this.powers=[],this.denseNDArray=[],this.powers=mt(t),void 0===e)for(var r=0;r<this.powers[this.powers.length-1];r++)this.denseNDArray[r]=null;else{if(e.length!=this.powers[this.powers.length-1])throw"Shape/dim doesn't agree with size ".concat(t);this.denseNDArray=e.slice()}};function mt(t){var e=[],r=1;e[0]=r;for(var n=0;n<t.length;n++)r*=t[n],e[n+1]=r;return e}function wt(t,e){if(t==e)return t;if(1==t||1==e)return t*e;throw"values are not one and they are different "}function bt(t,e){for(var r=t.shape(),n=[],i=0;i<r.length;i++)n.unshift(1==r[r.length-1-i]?0:e[e.length-1-i]);return 0==n.length?n.concat(0):n}dt.prototype.size=function(){return this.powers[this.powers.length-1]},dt.prototype.shape=function(){return this.dim},dt.prototype.get=function(t){if(null==t)return this.denseNDArray[0];if("number"==typeof t)return this.get([t]);if(t.constructor===Array)return this.checkIfIndexOutOfBounds(t),this.checkIfCoordSizeCompatible(t.length),this.denseNDArray[this.getIndex(t)];if(t.constructor===String){var e=this.getIntervalFromStr(t),r=this.computeNewDim(e);if(0==r.length){for(var n=[],i=0;i<e.length;i++)n.push(e[i][0]);return this.get(n)}for(var a=new dt(r),o=a.size(),u=[],s=[],c=0;c<e.length;c++)s[c]=e[c][1]-e[c][0]+1;for(var h=mt(s),f=0;f<o;f++){for(var l=0,p=0;p<e.length;p++){var v=Math.floor(f%h[l+1]/h[l]);u[p]=e[p][0]+v,l++}a.denseNDArray[f]=this.get(u)}return a}throw"method 'get' only accepts strings and integer arrays"},dt.prototype.set=function(t,e){if("number"==typeof t&&e.constructor!==Array)return this.set([t],e);if(t.constructor===Array&&e.constructor!==Array)return this.checkIfIndexOutOfBounds(t),this.checkIfCoordSizeCompatible(t.length),this.denseNDArray[this.getIndex(t)]=e,this;if(t.constructor===String&&e.constructor===dt){for(var r=this.getIntervalFromStr(t),n=e.size(),i=[],a=[],o=0;o<r.length;o++)a[o]=r[o][1]-r[o][0]+1;for(var u=mt(a),s=0;s<n;s++){for(var c=0,h=0;h<r.length;h++){var f=Math.floor(s%u[c+1]/u[c]);i[h]=r[h][0]+f,c++}this.set(i,e.denseNDArray[s])}return this}throw"set only accepts strings and integer arrays as the first argument and objects and DenseNDArray as the second"},dt.prototype.map=function(t){for(var e=this.copy(),r=this.size(),n=0;n<r;n++)e.denseNDArray[n]=t(this.denseNDArray[n]);return e},dt.prototype.mapWithIndex=function(t){for(var e=this.copy(),r=this.size(),n=this.dim,i=this.powers,a=[],o=0;o<r;o++){for(var u=0;u<n.length;u++)a[u]=Math.floor(o%i[u+1]/i[u]);e.denseNDArray[o]=t(this.denseNDArray[o],a)}return e},dt.prototype.reduce=function(t,e){for(var r=this.size(),n=0;n<r;n++)t=e(t,this.denseNDArray[n]);return t},dt.prototype.forEach=function(t){this.denseNDArray.forEach(t)},dt.prototype.transform=function(t){for(var e=this.size(),r=0;r<e;r++)this.denseNDArray[r]=t(this.denseNDArray[r]);return this},dt.prototype.transformWithIndex=function(t){for(var e=this.size(),r=this.dim,n=this.powers,i=[],a=0;a<e;a++){for(var o=0;o<r.length;o++)i[o]=Math.floor(a%n[o+1]/n[o]);this.denseNDArray[a]=t(this.denseNDArray[a],i)}return this},dt.prototype.toArray=function(){return this.toArrayRecursive([])},dt.prototype.toArrayRecursive=function(t){var e=[],r=t.length;if(r!=this.dim.length){for(var n=0;n<this.dim[this.dim.length-1-r];n++)e.push(this.toArrayRecursive([n].concat(t)));return e}return this.get(t)},dt.prototype.toString=function(){return this.toStringRecursive([])},dt.prototype.toStringRecursive=function(t){var e=[],r=t.length;if(r!=this.dim.length){e.push("[");for(var n=0;n<this.dim[this.dim.length-1-r];n++)e.push(this.toStringRecursive([n].concat(t)));e.push("]")}else e.push("".concat(this.get(t),", "));return e.join("")},dt.prototype.copy=function(){return dt.of(this.denseNDArray,this.dim)},dt.prototype.equals=function(t){return this==t||null!=t&&this.prototype==t.prototype&&(E.arrayEquals(this.denseNDArray,t.denseNDArray)&&E.arrayEquals(this.powers,t.powers)&&E.arrayEquals(this.dim,t.dim))},dt.prototype.hashCode=function(){throw"To be implemented in near future"},dt.prototype.getIndex=function(t){for(var e=0,r=Math.min(t.length,this.dim.length),n=0;n<r;n++)e+=t[t.length-n-1]*this.powers[this.dim.length-n-1];return e},dt.prototype.computeNewDim=function(t){for(var e=[],r=0;r<t.length;r++){var n=t[r][1]-t[r][0];0!==n&&e.push(n+1)}for(var i=[],a=0;a<e.length;a++)i[a]=e[a];return i},dt.prototype.getIntervalFromStr=function(t){var e=this,r=t.split(" ").join("").split(",");this.checkIfCoordSizeCompatible(r.length);for(var n=[],i=function(t){var i=r[t].split(":");({1:function(){var e=parseInt(i[0]);n[t]=[e,e]},2:function(){var r=Math.max(0,Math.min(e.dim[t]-1,""==i[0]?0:parseInt(i[0]))),a=Math.max(0,Math.min(e.dim[t]-1,""==i[1]?e.dim[t]-1:parseInt(i[1]))),o=[r,a];if(a-r==0)throw"empty interval xmax : ".concat(a," < xmin : ").concat(r);n[t]=o}})[i.length]()},a=0;a<r.length;a++)i(a);return n},dt.prototype.checkIfIndexOutOfBounds=function(t){var e=0==this.dim.length&&t[0]>0,r=0!=this.dim.length&&E.binaryOp(t,this.dim,(function(t,e){return t>=0&&t<e?0:1})).reduce((function(t,e){return t+e}))>0;if(e||r)throw"index out of bounds ".concat(t,", actual shape is ").concat(this.dim)},dt.prototype.checkIfCoordSizeCompatible=function(t){if(0!=this.dim.length&&t>this.dim.length)throw"Size dimension incorrect : ".concat(t,". Correct size dimension should be less or equal ").concat(this.dim.length)},dt.prototype.reshape=function(t){return dt.of(this,t)},dt.prototype.binaryOp=function(t,e){for(var r=this,n=this.shape(),i="number"==typeof t?dt.of(t):t,a=i.shape(),o=n.length<a.length?n:a,u=n.length<a.length?a:n,s=[],c=0;c<o.length;c++)try{s.push(wt(o[o.length-c-1],u[u.length-c-1]))}catch(t){throw"Dimensions ".concat(n," and ").concat(a," are not compatible for broadcast")}for(var h=o.length;h<u.length;h++)s.push(u[u.length-h-1]);return s=s.reverse(),new dt(s).transformWithIndex((function(t,n){var a=r.get(bt(r,n)),o=i.get(bt(i,n));return e(a,o)}))},dt.of=function(t,e){return t instanceof dt?new dt(void 0===e?t.dim:e,t.denseNDArray):function(t){return t.length>0&&void 0===t[0].length}(t)?t.length>0&&void 0===e?new dt([t.length],t):new dt(e,t):function(t){var e=E.findJsArrayDim(t),r=E.unpackJsArray(t);return dt.of(r,e)}(t)};var St=dt}])}));